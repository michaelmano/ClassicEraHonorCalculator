<div class="row">
    <form>
        <div>
            <label for="currentRank">Current Rank</label>
            <div class="input-group">
                <div class="input-group-text"><img [src]="'assets/rank-icons/' + currentRankNum + '.webp'"></div>
                <select class="form-select form-select-lg" [(ngModel)]="currentRankNum" name="currentRank"
                    id="currentRank">
                    <option *ngFor="let n of ranks" [ngValue]="n">
                        Rank {{ n }}
                    </option>
                </select>
            </div>
        </div>
        <div class="mt-3">
            <label for="rankProgress">Rank Progress (%)</label>
            <input type="text" [(ngModel)]="rankProgress" (beforeinput)="validateNumberBeforeInput($event, true)"
                (change)="validateNumberOnChange($event, 0, 100)" class="form-control font-monospace"
                name="rankProgress" autocomplete="off" id="rankProgress" [placeholder]="rankProgress">
        </div>
        <div class="bg-info-subtle border mt-2">
            <p class="m-2">
                You can type <code>/run print((GetPVPRankProgress()*100)..'%')</code> ingame to get the exact percentage
                <button type="button" class="btn btn-sm btn-outline-info    " (click)="copyTextToClipboard('/run print((GetPVPRankProgress()*100)..\'%\')')">Copy To Clipboard</button>
            </p>
        </div>
        <div class="mt-3">
            <label for="honorFarmed">Honor this week</label>
            <input type="text" [(ngModel)]="honorFarmed" (beforeinput)="validateNumberBeforeInput($event, false)"
                (change)="validateNumberOnChange($event, 0, 500000)" class="form-control font-monospace"
                name="honorFarmed" autocomplete="off" id="honorFarmed" [placeholder]="honorFarmed">
        </div>
    </form>
</div>
<div class="row mt-5">
    <div class="col">
        <div class="card">
            <h5 class="card-header">This Week</h5>
            <table class="table table-striped table-hover table-bordered mb-0">
                <tbody>
                    <tr>
                        <td>Rating</td>
                        <td class="font-monospace">{{ CalculateCurrentRating() }}</td>
                    </tr>
                    <tr>
                        <td>Qualified Rank</td>
                        <td class="font-monospace">{{ DisplayQualifiedRank() }}</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    <div class="col">
        <div class="card">
            <h5 class="card-header">Next Week</h5>
            <table class="table table-striped table-hover table-bordered mb-0">
                <tbody>
                    <tr>
                        <td>Rating</td>
                        <td class="font-monospace">
                            <!-- TODO: Placeholder until Decay gets implemented -->
                            <span class="badge bg-danger" *ngIf="CalculateNextRating() - CalculateCurrentRating() <= 0">Decaying</span>
                            <span *ngIf="CalculateNextRating() - CalculateCurrentRating() > 0">
                                {{ CalculateNextRating() }}
                                <span [ngClass]="{'badge': true, 'bg-success': CalculateNextRating() - CalculateCurrentRating() > 0, 'bg-danger': CalculateNextRating() - CalculateCurrentRating() <= 0}">
                                    <span *ngIf="CalculateNextRating() - CalculateCurrentRating() >= 0">+</span>
                                    {{ CalculateNextRating() - CalculateCurrentRating() }}
                                </span>
                            </span>
                        </td>
                    </tr>
                    <tr>
                        <td>Rank</td>
                        <td class="font-monospace">
                            <span>
                                {{ CalculateNextRankNum() }} ({{ DisplayNextRankPercentage() }}%)
                                <span [ngClass]="{'badge': true, 'bg-success': CalculateNextRankNum() - currentRankNum > 0, 'bg-warning': CalculateNextRankNum() - currentRankNum == 0}">{{ CalculateNextRankNum() - currentRankNum }}</span>
                            </span>
                        </td>
                    </tr>
                    <tr>
                        <td>Max Possible Rank</td>
                        <td class="font-monospace">{{ CalculateMaxNextRankNum() }}</td>
                    </tr>
                    <tr>
                        <td>Max Possible Rating Gain</td>
                        <td class="font-monospace">+{{ DisplayMaxRatingGain() }}</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
<h5 class="mt-5">min. Honor for max. Rating</h5>
<div class="progress" role="progressbar" style="height: 60px;">
    <div class="progress-bar bg-success overflow-visible" [ngStyle]="{ width: CalculateHonorFarmProgress() + '%' }">
        <span class="text-center fs-5 ps-2 pe-2">{{ honorFarmed }} / {{ CalculateMinimumHonorForMaxRatingGain() }} Honor</span>
        <span class="ps-2 pe-2">{{ CalculateHonorFarmProgress().toFixed(2) }}%</span>
    </div>
</div>
<div class="d-flex" style="height: 20px"> 
    <div *ngFor="let ms of qualificationMilestones; let i = index" class="progressbar-milestone" [ngStyle]="{ width: ms.HonorRequirementPercentage + '%' }">
        <span class="me-2">{{ i < qualificationMilestones.length - 1 ? ms.HonorRequirement : '' }}</span> 
    </div>
</div>